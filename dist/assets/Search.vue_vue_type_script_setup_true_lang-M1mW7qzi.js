import{f as e,b as a,_ as o}from"./Form.vue_vue_type_script_lang-DbCYn3dE.js";import{s,p as t,b as l,c as n,D as i,w as r,e as d,g as c,I as h,f as u,H as p,t as m,F as g,E as b,r as f,q as w,A as v,o as x,l as y}from"./index-DABr7JLZ.js";import{u as E}from"./useForm-Cl9wTA4n.js";import{c as _}from"./cloneDeep-BpdYEPoJ.js";const F=s({__name:"ActionButton",props:{showSearch:t.bool.def(!0),showReset:t.bool.def(!0),showExpand:t.bool.def(!1),visible:t.bool.def(!0),searchLoading:t.bool.def(!1),resetLoading:t.bool.def(!1)},emits:["search","reset","expand"],setup(e,{emit:a}){const o=a,s=()=>{o("search")},t=()=>{o("reset")},f=()=>{o("expand")};return(a,o)=>{const w=b;return l(),n(g,null,[e.showSearch?(l(),i(w,{key:0,type:"primary",loading:e.searchLoading,onClick:s},{default:r((()=>[d(c(h),{icon:"uil:search"}),u(" 查询 ")])),_:1},8,["loading"])):p("",!0),e.showReset?(l(),i(w,{key:1,plain:"",loading:e.resetLoading,onClick:t},{default:r((()=>[d(c(h),{icon:"carbon:reset"}),u(" 重置 ")])),_:1},8,["loading"])):p("",!0),e.showExpand?(l(),i(w,{key:2,plain:"",onClick:f},{default:r((()=>[d(c(h),{icon:e.visible?"iconamoon:arrow-down-2-bold":"iconamoon:arrow-up-2-bold"},null,8,["icon"]),u(" "+m(e.visible?"展开":"收起"),1)])),_:1})):p("",!0)],64)}}}),L={class:"component-search"},R=s({__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:t.bool.def(!1),labelWidth:t.oneOfType([String,Number]).def("auto"),layout:t.string.validate((e=>["inline","bottom"].includes(e))).def("inline"),buttonPosition:t.string.validate((e=>["left","center","right"].includes(e))).def("center"),showSearch:t.bool.def(!0),showReset:t.bool.def(!0),showExpand:t.bool.def(!1),expandField:t.string.def(""),inline:t.bool.def(!0),removeNoValueItem:t.bool.def(!0),model:{type:Object,default:()=>({})},searchLoading:t.bool.def(!1),resetLoading:t.bool.def(!1)},emits:["search","reset","register","validate"],setup(s,{expose:t,emit:i}){const r=s,h=i,m=f(!0),g=f(r.model),b=w((()=>{const a=c(D);let o=_(a.schema);if(a.showExpand&&a.expandField&&c(m)){const s=e(o,(e=>e.field===a.expandField));o.map(((e,a)=>(e.hidden=a>=s,e)))}return"inline"===a.layout&&(o=o.concat([{field:"action",formItemProps:{labelWidth:"0px",slots:{default:()=>d("div",null,[d(F,{showSearch:a.showSearch,showReset:a.showReset,showExpand:a.showExpand,searchLoading:a.searchLoading,resetLoading:a.resetLoading,visible:m.value,onExpand:N,onReset:I,onSearch:q},null)]),label:()=>d("span",null,[u(" ")])}}}])),o})),{formRegister:R,formMethods:S}=E(),{getElFormExpose:j,getFormData:k,getFormExpose:C}=S,O=f({}),A=f({}),D=w((()=>{const e={...r};return Object.assign(e,c(A)),e})),P=f([]);v((()=>c(b)),(async(e=[])=>{g.value=a(e,c(g)),P.value=e}),{immediate:!0,deep:!0});const V=async()=>await k(),q=async()=>{const e=await j();await(null==e?void 0:e.validate((async e=>{if(e){const e=await V();h("search",e)}})))},I=async()=>{const e=await j();null==e||e.resetFields();const a=await V();h("reset",a)},W=w((()=>({textAlign:c(D).buttonPosition}))),N=async()=>{m.value=!c(m)},B={getElFormExpose:j,setProps:(e={})=>{A.value=Object.assign(c(A),e),O.value=e},setValues:async(e={})=>{g.value=Object.assign(r.model,c(g),e);const a=await C();null==a||a.setValues(e)},getFormData:k};x((()=>{h("register",B)})),t(B);const H=(e,a,o)=>{h("validate",e,a,o)};return(e,a)=>(l(),n("div",L,[d(c(o),{model:g.value,"is-custom":!1,"label-width":D.value.labelWidth,"hide-required-asterisk":"",inline:D.value.inline,"is-col":D.value.isCol,schema:P.value,onRegister:c(R),onValidate:H},null,8,["model","label-width","inline","is-col","schema","onRegister"]),"bottom"===s.layout?(l(),n("div",{key:0,style:y(W.value)},[d(F,{"show-reset":D.value.showReset,"show-search":D.value.showSearch,"show-expand":D.value.showExpand,"search-loading":D.value.searchLoading,"reset-loading":D.value.resetLoading,visible:m.value,onExpand:N,onReset:I,onSearch:q},null,8,["show-reset","show-search","show-expand","search-loading","reset-loading","visible"])],4)):p("",!0)]))}});export{R as _};
